---
title: 蓝桥杯
date: 2023-03-27 23:21:11
tags:
---

# 统计子矩阵

```c
#include <iostream>
using namespace std;
const int N=510;
long long a[N][N];
int main()
{
	int n,m,k;
	cin>>n>>m>>k;
	for(int i=1;i<=n;i++)
	{
		for(int j=1;j<=m;j++)
		{
			scanf("%lld ",&a[i][j]);
			a[i][j]+=a[i-1][j]+a[i][j-1]-a[i-1][j-1];
		}
	}
	long long sum=0;
	for(int i=1;i<=n;i++)//开始行x1
	{
		for(int j=i;j<=n;j++)//截止行x2
		{
			int y=1;//开始列y1      这题也可以说是另类的减枝了，其实也就是4个循环的意思，只是把一层循环换了一种方式表达
			for(int x=1;x<=m;x++)//截止列y2
			{
				while(a[j][x]-a[j][y-1]-a[i-1][x]+a[i-1][y-1]>k&&y<=x)//判断该矩阵的和是否小于k
					     //大于y++，说明当前矩阵不满足条件
					     //小于，结束。说明现在这个矩阵从y-x间的矩阵都一定满足条件
				{
					y++;
				}
				sum+=x-y+1;
			}
		}
	}
	printf("%lld\n",sum);
	return 0;
}
//在这要搞明白一点，每次的判断只与当前行j(x2)有关，什么意思呢
//就是关于j-1行的已经求过了，不用再算
//例题：
//当i=1，j=1时，有10种情况  //x=4时，(1,1)-(1,4)<=k,说明有(1,1)-(1,4),(1,2)-(1,4),(1,3)-(1,4),(1,4)-(1,4)这4种情况满足条件
//i=1，j=2时，x=1,有一种情况(1,1)-(2,1)  x=2时，因为(1,1)-(2,2)大于k，y++,此时(1,2)-(2,2)小于k，加一
//i=2,j=2,x=1时，可求得(2,1)-(2,1),(2,2)-(2,2),(2,3)-(2,3)
```

